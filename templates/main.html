<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Forum - Ana Sayfa</title>
  <style>
    :root{
      --bg:#f3f4f6; --card:#ffffff; --muted:#6b7280; --accent:#374151; --soft:#e5e7eb; --radius:12px; --max-width:1200px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#eef2f6);color:var(--accent)}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max-width);margin:36px auto;padding:20px}
    header.site{display:flex;align-items:center;gap:20px;margin-bottom:20px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,#fff,#f7f7f7);display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(15,23,42,0.06);font-weight:700;color:var(--accent)}
    .title{font-size:18px;font-weight:700}
    .subtitle{font-size:13px;color:var(--muted)}
    .search-wrap{flex:1;display:flex;align-items:center}
    .search{width:100%;display:flex;align-items:center;background:var(--card);border-radius:999px;padding:8px 12px;box-shadow:0 2px 8px rgba(15,23,42,0.04);border:1px solid var(--soft)}
    .search input{flex:1;border:0;outline:none;padding:8px;font-size:14px;background:transparent}
    .user-actions{display:flex;gap:10px;align-items:center}
    .btn{background:var(--card);border:1px solid var(--soft);padding:8px 12px;border-radius:10px;cursor:pointer}
    .primary{background:#f8fafc;border:0;padding:10px 14px;border-radius:10px;box-shadow:0 6px 18px rgba(15,23,42,0.04);}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:20px}
    .panel{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 6px 18px rgba(15,23,42,0.03);border:1px solid var(--soft)}
    .panel h3{margin:0 0 12px 0;font-size:16px}
    .categories{display:flex;gap:12px;flex-wrap:wrap}
    .cat{background:linear-gradient(180deg,#fafafa,#fff);padding:12px;border-radius:10px;border:1px solid var(--soft);min-width:160px;flex:1}
    .cat h4{margin:0;font-size:14px}
    .muted{color:var(--muted);font-size:13px}
    .topics-list{margin-top:10px;border-top:1px solid var(--soft)}
    .topic{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--soft)}
    .topic .left{display:flex;gap:12px;align-items:center}
    .avatar{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#f3f4f6,#ffffff);display:flex;align-items:center;justify-content:center;color:var(--muted);font-weight:700}
    .meta{font-size:13px}
    .topic .right{display:flex;gap:10px;align-items:center}
    .badge{background:var(--bg);padding:6px 8px;border-radius:8px;font-size:13px}
    .sidebar .card{margin-bottom:12px}
    .profile{display:flex;gap:12px;align-items:center}
    .profile .name{font-weight:700}
    .small{font-size:13px;color:var(--muted)}
    .create-topic{display:block;text-align:center;padding:10px;border-radius:10px;border:1px dashed var(--soft);background:linear-gradient(180deg,#fff,#fbfbfb);cursor:pointer}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} .user-actions{display:none} header.site{flex-direction:column;align-items:stretch;gap:12px} }

    /* clickable topic */
    .topic-link{display:flex;gap:12px;align-items:center;color:inherit;padding:8px;border-radius:8px}
    .topic-link:hover{background:#fbfdff}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="site">
      <div class="brand">
        <div class="logo">F</div>
        <div>
          <div class="title">Forum</div>
          <div class="subtitle">Güncel konular ve topluluklar</div>
        </div>
      </div>

      <div class="search-wrap">
        <div class="search" role="search">
          <input aria-label="Ara" placeholder="Ara: konu..." />
          <button aria-label="ara">Ara</button>
        </div>
      </div>

      <div class="user-actions">

        {% if role == "admin" %}
        <a class="btn" href="/setrole">Admin Panel</a>
    {% else %}
        
    {% endif %}

        <a class="btn" href="/logout">Çıkış Yap</a>
      </div>
    </header>

    <main class="grid">
  <section class="panel">
    <h3>Popüler Kategoriler</h3>
    <div class="categories">

      {% if topPopularTopics and topPopularTopics|length > 0 %}
        {% for t in topPopularTopics %}
        <div class="cat">
          <h4><a href="/topic/{{t.id}}">{{t.title}}</a></h4>
          <div class="muted">Görüntülenme Sayısı: ({{ t.visit_count }})</div>
        </div>
        {% endfor %}
      {% else %}
        <div class="cat">
          <h4>Henüz Popüler Konu Yok</h4>
          <div class="muted">Ziyaret edilen konu bulunamadı</div>
        </div>
      {% endif %}

    </div>


        <h3 style="margin-top:18px">Resmi Konular</h3>
        <div class="topics-list">
          {% for r in resmi_konular %}
          <div class="topic">
            <div class="left">
              <div class="avatar">{{ r.author[0] }}</div>
              <div>
                <div style="font-weight:600"><a href=' {{ r.link }} '>{{ r.title }}</a></div>
                <div class="meta small">@{{ r.author }} 
                  
                      {% if role == "admin" %}
        <span style="color: red; font-weight: bold;">Admin</span>
    {% elif role == "moderator" %}
        <span style="color: purple; font-weight: bold;">Moderatör</span>
    {% else %}
        <span style="color: gray;">Üye</span>
    {% endif %}
                  · Son Güncelleme [{{ r.date }}]</div>
              </div>
            </div>
            <div class="right">
            </div>
          </div>
          {% endfor %}
        </div>

        <h3 style="margin-top:18px">Genel Konular</h3>
        <div class="topics-list">
          {% if general_topics %}
            {% for t in general_topics %}
            <a href="/topic/{{ t.id }}" class="topic-link" style="display:block">
              <div style="display:flex;align-items:center;justify-content:space-between;width:100%">
                <div class="left" style="display:flex;gap:12px;align-items:center">
                  <div class="avatar">{{ t.author[0] }}</div>
                  <div>
                    <div style="font-weight:600">{{ t.title }}</div>
                    <div class="meta small">@{{ t.author }} 
    {% if role == "admin" %}
        <span style="color: red; font-weight: bold;">Admin</span>
    {% elif role == "moderator" %}
        <span style="color: rgb(67, 3, 67); font-weight: bold;">Moderatör</span>
    {% else %}
        <span style="color: gray;">Üye</span>
    {% endif %} · Tarih: [{{ t.date }}]   Görüntülenme Sayısı: ({{ t.visit_count }})</div>
                  </div>
                </div>
                <div class="right">
                  <div class="badge">ID: {{ t.id }}</div>
                </div>
              </div>
            </a>
            {% endfor %}
          {% else %}
            <div class="small muted" style="padding:12px">Henüz genel konuda bir konu oluşturulmamış.</div>
          {% endif %}
        </div>

      </section>

      <aside class="sidebar">
        <div class="panel card">
          <div class="profile">
            <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#fff,#f7f7f7);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted)">{{ username[0] if username }}</div>
            <div>
              <div style="position: relative; left: 160px; top: 28px;">
            {% if role == "admin" %}
        <span style="color: red; font-weight: bold;"><a href="/admin/logs" class="btn">Log</a></span>
    {% elif role == "moderator" %}
        <span style="color: purple; font-weight: bold;"></span>
    {% else %}
        <span style="color: gray;"></span>
    {% endif %}
          </div>
              <div class="name">{{ username }}</div>
              <div class="small">{% if role == "admin" %}
        <span style="color: red; font-weight: bold;">Admin</span>
    {% elif role == "moderator" %}
        <span style="color: purple; font-weight: bold;">Moderatör</span>
    {% else %}
        <span style="color: gray;">Üye</span>
    {% endif %}</div>
            </div>
          </div>
          <div style="margin-top:12px">
            <a href="/create-topic" class="create-topic">+ Yeni Konu Oluştur</a>
          </div>
        </div>

        <div class="panel card">
  <h3>Aktif Yetkililer</h3>
  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">

    {% for admin in aktif_adminler %}
      <div class="avatar" style="
        width:40px;
        height:40px;
        border-radius:8px;
        background:#e2e2e2;
        color:rgb(255, 0, 0);
        display:flex;
        justify-content:center;
        align-items:center;
        font-weight:bold;
        font-size:20px;
      ">
        {{ admin[0] | upper }}
      </div>
    {% endfor %}

    {% if aktif_adminler|length == 0 %}
      <p style="color:#888;font-size:14px">Aktif Yetkili yok</p>
    {% endif %}

  </div>
</div>


        <div class="panel card">
          <h3>Etiketler</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
            <div class="badge">#Fivem</div>
            <div class="badge">#CRP</div>
            <div class="badge">#Resmi</div>
            <div class="badge">#Genel</div>
          </div>
        </div>

      </aside>
    </main>

    <footer>
      © 2025 CloneRolePlay Forum • © www.Cloneroleplay.com.tr
    </footer>
  </div>
</body>
</html>
